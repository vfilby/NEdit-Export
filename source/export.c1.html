<html><body bgcolor="#ffffff"><pre><font color="#333333"><i>/*******************************************************************************
*                                                                               
* export.c -- Nirvana Editor menus                                               
*                                                                               
* Copyright (C) 2001 Vincent Filby
*                                                                               
* This is free software; you can redistribute it and/or modify it under the    
* terms of the GNU General Public License as published by the Free Software    
* Foundation; either version 2 of the License, or (at your option) any later   
* version.                                                                       
*                                                                                
* This software is distributed in the hope that it will be useful, but WITHOUT 
* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or        
* FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License 
* for more details.                                                               
*                                                                                
* You should have received a copy of the GNU General Public License along with 
* software; if not, write to the Free Software Foundation, Inc., 59 Temple     
* Place, Suite 330, Boston, MA  02111-1307 USA                                       
*                                                                               
* Nirvana Text Editor                                                                   
* May 3rd, 2001                                                                       
*                                                                               
* Written by Vincent Filby                                                               
*                                                                               
*/</i></font><font color="#000000">
</font><font color="#27408B">#include &lt;stdlib.h&gt;</font><font color="#000000">
</font><font color="#27408B">#include &lt;stdio.h&gt;</font><font color="#000000">
</font><font color="#27408B">#include &lt;errno.h&gt;</font><font color="#000000">
</font><font color="#27408B">#include &lt;string.h&gt;</font><font color="#000000">
</font><font color="#27408B">#ifdef VMS</font><font color="#000000">
</font><font color="#27408B">#include "../util/VMSparam.h"</font><font color="#000000">
</font><font color="#27408B">#else</font><font color="#000000">
</font><font color="#27408B">#include &lt;sys/param.h&gt;</font><font color="#000000">
</font><font color="#27408B">#endif </font><font color="#333333"><i>/*VMS*/</i></font><font color="#000000">
</font><font color="#27408B">#include &lt;X11/X.h&gt;</font><font color="#000000">
</font><font color="#27408B">#include &lt;X11/Xatom.h&gt;</font><font color="#000000">
</font><font color="#27408B">#include &lt;Xm/Xm.h&gt;</font><font color="#000000">
</font><font color="#27408B">#include &lt;Xm/CascadeB.h&gt;</font><font color="#000000">
</font><font color="#27408B">#include &lt;Xm/PushB.h&gt;</font><font color="#000000">
</font><font color="#27408B">#include &lt;Xm/ToggleB.h&gt;</font><font color="#000000">
</font><font color="#27408B">#include &lt;Xm/FileSB.h&gt;</font><font color="#000000">
</font><font color="#27408B">#include "../util/getfiles.h"</font><font color="#000000">
</font><font color="#27408B">#include "../util/fontsel.h" </font><font color="#333333"><i>/*... get rid of this */</i></font><font color="#000000">
</font><font color="#27408B">#include "../util/DialogF.h"</font><font color="#000000">
</font><font color="#27408B">#include "../util/misc.h"</font><font color="#000000">
</font><font color="#27408B">#include "../util/fileUtils.h"</font><font color="#000000">
</font><font color="#27408B">#include "textBuf.h"</font><font color="#000000">
</font><font color="#27408B">#include "text.h"</font><font color="#000000">
</font><font color="#27408B">#include "nedit.h"</font><font color="#000000">
</font><font color="#27408B">#include "file.h"</font><font color="#000000">
</font><font color="#27408B">#include "menu.h"</font><font color="#000000">
</font><font color="#27408B">#include "window.h"</font><font color="#000000">
</font><font color="#27408B">#include "search.h"</font><font color="#000000">
</font><font color="#27408B">#include "selection.h"</font><font color="#000000">
</font><font color="#27408B">#include "undo.h"</font><font color="#000000">
</font><font color="#27408B">#include "shift.h"</font><font color="#000000">
</font><font color="#27408B">#include "help.h"</font><font color="#000000">
</font><font color="#27408B">#include "preferences.h"</font><font color="#000000">
</font><font color="#27408B">#include "tags.h"</font><font color="#000000">
</font><font color="#27408B">#include "userCmds.h"</font><font color="#000000">
</font><font color="#27408B">#include "shell.h"</font><font color="#000000">
</font><font color="#27408B">#include "macro.h"</font><font color="#000000">
</font><font color="#27408B">#include "highlight.h"</font><font color="#000000">
</font><font color="#27408B">#include "highlightData.h"</font><font color="#000000">
</font><font color="#27408B">#include "rbTree.h"</font><font color="#000000">
</font><font color="#27408B">#include "interpret.h"</font><font color="#000000">
</font><font color="#27408B">#include "smartIndent.h"</font><font color="#000000">
</font><font color="#27408B">#include "export.h"</font><font color="#000000">
</font><font color="#27408B">#include "regularExp.h"</font><font color="#000000">
</font><font color="#27408B">#include "textDisp.h"</font><font color="#000000">
</font><font color="#27408B">#include "textSel.h"</font><font color="#000000">
</font><font color="#27408B">#include "textP.h"</font><font color="#000000">


</font><font color="#333333"><i>/* These defines and structsare taken from
 * highlightData.c.  They have been put here
 * because they were not in the public header */</i></font><font color="#000000">
</font><font color="#27408B">#define FILL_MASK 0x100</font><font color="#000000">
</font><font color="#27408B">#define SECONDARY_MASK 0x200</font><font color="#000000">
</font><font color="#27408B">#define PRIMARY_MASK 0x400</font><font color="#000000">
</font><font color="#27408B">#define HIGHLIGHT_MASK 0x800</font><font color="#000000">
</font><font color="#27408B">#define STYLE_LOOKUP_MASK 0xff</font><font color="#000000">

</font><font color="#A52A2A"><b>typedef</b></font><font color="#000000"> </font><font color="#A52A2A"><b>struct</b></font><font color="#000000"> </font><font color="#27408B">_highlightDataRec</font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
    </i></font><font color="#27408B">regexp</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">startRE</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#27408B">regexp</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">endRE</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#27408B">regexp</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">errorRE</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#27408B">regexp</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">subPatternRE</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#27408B">style</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">colorOnly</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A"><b>signed</b></font><font color="#000000"> </font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#27408B">startSubexprs</font><font color="#000000"><b>[</b></font><font color="#27408B">NSUBEXP</font><font color="#000000"><b>+</b></font><font color="#006400">1</font><font color="#000000"><b>]</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A"><b>signed</b></font><font color="#000000"> </font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#27408B">endSubexprs</font><font color="#000000"><b>[</b></font><font color="#27408B">NSUBEXP</font><font color="#000000"><b>+</b></font><font color="#006400">1</font><font color="#000000"><b>]</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">flags</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">nSubPatterns</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A"><b>struct</b></font><font color="#000000"> </font><font color="#27408B">_highlightDataRec</font><font color="#000000"> </font><font color="#000000"><b>**</b></font><font color="#27408B">subPatterns</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
</i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i> </i></font><font color="#27408B">highlightDataRec</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>

</i></font><font color="#333333"><i>/* Context requirements for incremental reparsing of a pattern set */</i></font><font color="#000000">
</font><font color="#A52A2A"><b>typedef</b></font><font color="#000000"> </font><font color="#A52A2A"><b>struct</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">nLines</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">nChars</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
</i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i> </i></font><font color="#27408B">reparseContext</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>

</i></font><font color="#333333"><i>/* Data structure attached to window to hold all syntax highlighting
   information (for both drawing and incremental reparsing) */</i></font><font color="#000000">
</font><font color="#A52A2A"><b>typedef</b></font><font color="#000000"> </font><font color="#A52A2A"><b>struct</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
    </i></font><font color="#27408B">highlightDataRec</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">pass1Patterns</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#27408B">highlightDataRec</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">pass2Patterns</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">majorStyles</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#27408B">reparseContext</font><font color="#000000"> </font><font color="#27408B">contextRequirements</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#27408B">styleTableEntry</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">styleTable</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">nStyles</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#27408B">textBuffer</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">styleBuffer</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
</i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i> </i></font><font color="#27408B">windowHighlightData</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
</i></font><font color="#333333"><i>/* End of definitions form highlightData.c */</i></font><font color="#000000">

</font><font color="#333333"><i>/* Max length of an html tag */</i></font><font color="#000000">
</font><font color="#27408B">#define MAX_TAG_LENGTH 30</font><font color="#000000">


</font><font color="#A52A2A"><b>static</b></font><font color="#000000"> </font><font color="#A52A2A"><b>void</b></font><font color="#000000"> </font><font color="#A52A2A">exportToHTML</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">Widget</font><font color="#000000"> </font><font color="#27408B">w</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XEvent</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">event</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">String</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">args</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">Cardinal</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">nArgs</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
</i></font><font color="#A52A2A"><b>static</b></font><font color="#000000"> </font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#A52A2A">errorString</font><font color="#000000"><b>(</b></font><font color="#A52A2A"><b>void</b></font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
</i></font><font color="#A52A2A"><b>void</b></font><font color="#000000"> </font><font color="#A52A2A">export</font><font color="#000000"><b>(</b></font><font color="#27408B">Widget</font><font color="#000000"> </font><font color="#27408B">w</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XEvent</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">event</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">String</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">args</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">Cardinal</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">nArgs</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
</i></font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#A52A2A">PromptForHTMLFile</font><font color="#000000"><b>(</b></font><font color="#27408B">WindowInfo</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">window</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">prompt</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">fullname</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
</i></font><font color="#A52A2A"><b>static</b></font><font color="#000000"> </font><font color="#A52A2A"><b>void</b></font><font color="#000000"> </font><font color="#A52A2A">exportToHTML</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">Widget</font><font color="#000000"> </font><font color="#27408B">w</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XEvent</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">event</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">String</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">args</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">Cardinal</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">nArgs</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
</i></font><font color="#A52A2A"><b>static</b></font><font color="#000000"> </font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#A52A2A">errorString</font><font color="#000000"><b>(</b></font><font color="#A52A2A"><b>void</b></font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
</i></font><font color="#A52A2A"><b>static</b></font><font color="#000000"> </font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#A52A2A">styleOfPos</font><font color="#000000"><b>(</b></font><font color="#27408B">textDisp</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">textD</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">lineStartPos</font><font color="#000000"><b>,</b></font><font color="#000000">
            </font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">lineLen</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">lineIndex</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">dispIndex</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
</i></font><font color="#A52A2A"><b>static</b></font><font color="#000000"> </font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#A52A2A">inSelection</font><font color="#000000"><b>(</b></font><font color="#27408B">selection</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">sel</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">pos</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">lineStartPos</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">dispIndex</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
</i></font><font color="#A52A2A"><b>static</b></font><font color="#000000"> </font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#A52A2A">max</font><font color="#000000"><b>(</b></font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">i1</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">i2</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
</i></font><font color="#A52A2A"><b>static</b></font><font color="#000000"> </font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#A52A2A">min</font><font color="#000000"><b>(</b></font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">i1</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">i2</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>


</i></font><font color="#333333"><i>/********************
 *  void exportAP
 *
 * DESCRIPTION
 *
 * RETURNS
 *         static
 *
 */</i></font><font color="#000000">
</font><font color="#A52A2A"><b>void</b></font><font color="#000000"> </font><font color="#A52A2A">export</font><font color="#000000"><b>(</b></font><font color="#27408B">Widget</font><font color="#000000"> </font><font color="#27408B">w</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XEvent</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">event</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">String</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">args</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">Cardinal</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">nArgs</font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
                
        </i></font><font color="#A52A2A">exportToHTML</font><font color="#000000"><b>(</b></font><font color="#27408B">w</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">event</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">args</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">nArgs</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>                
</i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i> </i></font><font color="#333333"><i>/* export */</i></font><font color="#000000">


</font><font color="#333333"><i>/********************
 *  exportToHTML
 *
 * DESCRIPTION
 *  Exports code to HTML with the syntax highlighting.
 *
 * RETURNS
 *         int
 *
 */</i></font><font color="#000000">
</font><font color="#A52A2A"><b>static</b></font><font color="#000000"> </font><font color="#A52A2A"><b>void</b></font><font color="#000000"> </font><font color="#A52A2A">exportToHTML</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">Widget</font><font color="#000000"> </font><font color="#27408B">w</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XEvent</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">event</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">String</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">args</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">Cardinal</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">nArgs</font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">i</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">j</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">response</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">fileLen</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">screenNum</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#A52A2A">XScreenNumberOfScreen</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#A52A2A">XtScreen</font><font color="#000000"><b>(</b></font><font color="#27408B">w</font><font color="#000000"><b>))</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#000000"><b>**</b></font><font color="#27408B">colorTagData</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#000000"><b>**</b></font><font color="#27408B">colorTagCloseData</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#27408B">lastStyle</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#000000"><b>-</b></font><font color="#006400">1</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#27408B">currentStyle</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">fileString</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#27408B">NULL</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">styleString</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#27408B">NULL</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#27408B">name</font><font color="#000000"><b>[</b></font><font color="#27408B">MAXPATHLEN</font><font color="#000000"><b>]</b></font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#006400">""</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#27408B">FILE</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">fp</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#27408B">NULL</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>

        </i></font><font color="#27408B">XColor</font><font color="#000000"> </font><font color="#27408B">color</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#27408B">WindowInfo</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">window</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#A52A2A">WidgetToWindow</font><font color="#000000"><b>(</b></font><font color="#27408B">w</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#27408B">Display</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">display</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#A52A2A">XtDisplay</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">w</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>                
        </i></font><font color="#27408B">Colormap</font><font color="#000000"> </font><font color="#27408B">colormap</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#A52A2A">DefaultColormap</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">display</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">screenNum</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#27408B">windowHighlightData</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">highlightData</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#27408B">textDisp</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">textD</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#000000"><b>((</b></font><font color="#27408B">TextWidget</font><font color="#000000"><b>)</b></font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">textArea</font><font color="#000000"><b>)</b></font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">text</font><font color="#000000"><b>.</b></font><font color="#27408B">textD</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">tabDist</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#A52A2A">BufGetTabDistance</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">buffer</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>

        </i></font><font color="#333333"><i>/*Is syntaxhighlighting turned on?*/</i></font><font color="#000000">
        </font><font color="#000000"><b>if</b></font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#000000"><b>!</b></font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">highlightSyntax</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
                </i></font><font color="#A52A2A">DialogF</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">DF_WARN</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">shell</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">1</font><font color="#000000"><b>,</b></font><font color="#000000">
                        </font><font color="#006400">"Turn on syntax highlighting before exporting."</font><font color="#000000"><b>,</b></font><font color="#000000">
                        </font><font color="#006400">"Dismiss"</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#000000"><b>return</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>                
        </i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i>                   

        </i></font><font color="#27408B">response</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#A52A2A">PromptForHTMLFile</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">window</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"Export to HTML:"</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">name</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>



        </i></font><font color="#000000"><b>if</b></font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">response</font><font color="#000000"> </font><font color="#000000"><b>!=</b></font><font color="#000000">        </font><font color="#27408B">GFN_OK</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000">
                </font><font color="#000000"><b>return</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#333333"><i>/* open the file */</i></font><font color="#000000">
</font><font color="#27408B">#ifdef VMS</font><font color="#000000">
        </font><font color="#000000"><b>if</b></font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#000000"><b>(</b></font><font color="#27408B">fp</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#A52A2A">fopen</font><font color="#000000"><b>(</b></font><font color="#27408B">name</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"w"</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"rfm = stmlf"</font><font color="#000000"><b>))</b></font><font color="#000000"> </font><font color="#000000"><b>==</b></font><font color="#000000"> </font><font color="#27408B">NULL</font><font color="#000000">  </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
</i></font><font color="#27408B">#else</font><font color="#000000">
        </font><font color="#000000"><b>if</b></font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#000000"><b>(</b></font><font color="#27408B">fp</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#A52A2A">fopen</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">name</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"w"</font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>==</b></font><font color="#000000"> </font><font color="#27408B">NULL</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
</i></font><font color="#27408B">#endif </font><font color="#333333"><i>/* VMS */</i></font><font color="#000000">
                </font><font color="#A52A2A">DialogF</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">DF_WARN</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">shell</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">1</font><font color="#000000"><b>,</b></font><font color="#000000">
                        </font><font color="#006400">"Unable to open file %s:</font><font color="#2E8B57">\n</font><font color="#006400">%s"</font><font color="#000000"><b>,</b></font><font color="#000000">
                        </font><font color="#006400">"Dissmiss"</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">name</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#A52A2A">errorString</font><font color="#000000"><b>()</b></font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#000000"><b>return</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i>                    

        </i></font><font color="#333333"><i>/* Begin long wait */</i></font><font color="#000000">
        </font><font color="#A52A2A">BeginWait</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">shell</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A">XmUpdateDisplay</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">shell</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>

        </i></font><font color="#27408B">highlightData</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#000000"><b>(</b></font><font color="#27408B">windowHighlightData</font><font color="#000000"><b>*</b></font><font color="#000000"><b>)</b></font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">highlightData</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>                
        </i></font><font color="#27408B">fileLen</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">buffer</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">length</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#27408B">fileString</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#A52A2A">BufGetAll</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">buffer</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>

        </i></font><font color="#27408B">colorTagData</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#000000"><b>(</b></font><font color="#A52A2A"><b>char</b></font><font color="#000000"><b>**</b></font><font color="#000000"><b>)</b></font><font color="#A52A2A">XtMalloc</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#A52A2A">sizeof</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#A52A2A"><b>char</b></font><font color="#000000"><b>*</b></font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#000000"> </font><font color="#27408B">highlightData</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">nStyles</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#27408B">colorTagCloseData</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#000000"><b>(</b></font><font color="#A52A2A"><b>char</b></font><font color="#000000"><b>**</b></font><font color="#000000"><b>)</b></font><font color="#A52A2A">XtMalloc</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#A52A2A">sizeof</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#A52A2A"><b>char</b></font><font color="#000000"><b>*</b></font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#000000"> </font><font color="#27408B">highlightData</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">nStyles</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>

        </i></font><font color="#333333"><i>/* For each style extract the font attributes and
         * color.  Then convert them to html tags 
         */</i></font><font color="#000000">                
        </font><font color="#000000"><b>for</b></font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">i</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#006400">0</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i> </i></font><font color="#27408B">i</font><font color="#000000"> </font><font color="#000000"><b>&lt;</b></font><font color="#000000"> </font><font color="#27408B">highlightData</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">nStyles</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i> </i></font><font color="#27408B">i</font><font color="#000000"><b>++</b></font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
                </i></font><font color="#27408B">colorTagData</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#A52A2A">XtMalloc</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#A52A2A">sizeof</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#000000"> </font><font color="#27408B">MAX_TAG_LENGTH</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#27408B">colorTagCloseData</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#A52A2A">XtMalloc</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#A52A2A">sizeof</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#000000"> </font><font color="#27408B">MAX_TAG_LENGTH</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>

                </i></font><font color="#27408B">color</font><font color="#000000"><b>.</b></font><font color="#27408B">pixel</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#27408B">highlightData</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">styleTable</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"><b>.</b></font><font color="#27408B">color</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#A52A2A">XQueryColor</font><font color="#000000"><b>(</b></font><font color="#000000">  </font><font color="#27408B">display</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">colormap</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#000000"><b>&</b></font><font color="#27408B">color</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>

                </i></font><font color="#000000"><b>if</b></font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">highlightData</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">styleTable</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"><b>.</b></font><font color="#27408B">font</font><font color="#000000"> </font><font color="#000000"><b>==</b></font><font color="#000000"> </font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">italicFontStruct</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
                        </i></font><font color="#A52A2A">sprintf</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">colorTagData</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"&lt;font color=</font><font color="#2E8B57">\"</font><font color="#006400">#%02hX%02hX%02hX</font><font color="#2E8B57">\"</font><font color="#006400">&gt;&lt;i&gt;"</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">color</font><font color="#000000"><b>.</b></font><font color="#27408B">red</font><font color="#000000"><b>/</b></font><font color="#006400">257</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">color</font><font color="#000000"><b>.</b></font><font color="#27408B">green</font><font color="#000000"><b>/</b></font><font color="#006400">257</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">color</font><font color="#000000"><b>.</b></font><font color="#27408B">blue</font><font color="#000000"><b>/</b></font><font color="#006400">257</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                        </i></font><font color="#A52A2A">sprintf</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">colorTagCloseData</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"&lt;/i&gt;&lt;/font&gt;"</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i> </i></font><font color="#000000"><b>else</b></font><font color="#000000"> </font><font color="#000000"><b>if</b></font><font color="#000000"> </font><font color="#000000"><b>(</b></font><font color="#27408B">highlightData</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">styleTable</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"><b>.</b></font><font color="#27408B">font</font><font color="#000000"> </font><font color="#000000"><b>==</b></font><font color="#000000"> </font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">boldFontStruct</font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
                        </i></font><font color="#A52A2A">sprintf</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">colorTagData</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"&lt;font color=</font><font color="#2E8B57">\"</font><font color="#006400">#%02hX%02hX%02hX</font><font color="#2E8B57">\"</font><font color="#006400">&gt;&lt;b&gt;"</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">color</font><font color="#000000"><b>.</b></font><font color="#27408B">red</font><font color="#000000"><b>/</b></font><font color="#006400">257</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">color</font><font color="#000000"><b>.</b></font><font color="#27408B">green</font><font color="#000000"><b>/</b></font><font color="#006400">257</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">color</font><font color="#000000"><b>.</b></font><font color="#27408B">blue</font><font color="#000000"><b>/</b></font><font color="#006400">257</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                        </i></font><font color="#A52A2A">sprintf</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">colorTagCloseData</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"&lt;/b&gt;&lt;/font&gt;"</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i> </i></font><font color="#000000"><b>else</b></font><font color="#000000"> </font><font color="#000000"><b>if</b></font><font color="#000000"> </font><font color="#000000"><b>(</b></font><font color="#27408B">highlightData</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">styleTable</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"><b>.</b></font><font color="#27408B">font</font><font color="#000000"> </font><font color="#000000"><b>==</b></font><font color="#000000"> </font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">boldItalicFontStruct</font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
                        </i></font><font color="#A52A2A">sprintf</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">colorTagData</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"&lt;font color=</font><font color="#2E8B57">\"</font><font color="#006400">#%02hX%02hX%02hX</font><font color="#2E8B57">\"</font><font color="#006400">&gt;&lt;i&gt;&lt;b&gt;"</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">color</font><font color="#000000"><b>.</b></font><font color="#27408B">red</font><font color="#000000"><b>/</b></font><font color="#006400">257</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">color</font><font color="#000000"><b>.</b></font><font color="#27408B">green</font><font color="#000000"><b>/</b></font><font color="#006400">257</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">color</font><font color="#000000"><b>.</b></font><font color="#27408B">blue</font><font color="#000000"><b>/</b></font><font color="#006400">257</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                        </i></font><font color="#A52A2A">sprintf</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">colorTagCloseData</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"&lt;/b&gt;&lt;/i&gt;&lt;/font&gt;"</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i> </i></font><font color="#000000"><b>else</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
                        </i></font><font color="#A52A2A">sprintf</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">colorTagData</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"&lt;font color=</font><font color="#2E8B57">\"</font><font color="#006400">#%02hX%02hX%02hX</font><font color="#2E8B57">\"</font><font color="#006400">&gt;"</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">color</font><font color="#000000"><b>.</b></font><font color="#27408B">red</font><font color="#000000"><b>/</b></font><font color="#006400">257</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">color</font><font color="#000000"><b>.</b></font><font color="#27408B">green</font><font color="#000000"><b>/</b></font><font color="#006400">257</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">color</font><font color="#000000"><b>.</b></font><font color="#27408B">blue</font><font color="#000000"><b>/</b></font><font color="#006400">257</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                        </i></font><font color="#A52A2A">sprintf</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">colorTagCloseData</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"&lt;/font&gt;"</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i>
        </i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i>


        </i></font><font color="#333333"><i>/* Change this to be an option? output bare HTML or
         * a complete html page.  Note the closing html
         * body, and pre tags below */</i></font><font color="#000000">
        </font><font color="#A52A2A">fprintf</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">fp</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"&lt;html&gt;&lt;body bgcolor=</font><font color="#2E8B57">\"</font><font color="#006400">#ffffff</font><font color="#2E8B57">\"</font><font color="#006400">&gt;&lt;pre&gt;"</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#000000"><b>for</b></font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">i</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#006400">0</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i> </i></font><font color="#27408B">i</font><font color="#000000"> </font><font color="#000000"><b>&lt;</b></font><font color="#000000"> </font><font color="#27408B">fileLen</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i> </i></font><font color="#27408B">i</font><font color="#000000"><b>++</b></font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
                </i></font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">currentLine</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">currentChar</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#27408B">currentStyle</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#A52A2A">BufGetCharacter</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">highlightData</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">styleBuffer</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">i</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>

                </i></font><font color="#333333"><i>/* If the style is unfinished, use the unfinished call back
                 * to fill in the unfinished style */</i></font><font color="#000000">
                </font><font color="#000000"><b>if</b></font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">currentStyle</font><font color="#000000"> </font><font color="#000000"><b>==</b></font><font color="#000000"> </font><font color="#27408B">textD</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">unfinishedStyle</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
                        </i></font><font color="#000000"><b>(</b></font><font color="#27408B">textD</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">unfinishedHighlightCB</font><font color="#000000"><b>)(</b></font><font color="#000000"> </font><font color="#27408B">textD</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">i</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">textD</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">highlightCBArg</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                        </i></font><font color="#27408B">currentStyle</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#A52A2A">BufGetCharacter</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">highlightData</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">styleBuffer</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">i</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i>
                </i></font><font color="#000000"><b>if</b></font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">currentStyle</font><font color="#000000"> </font><font color="#000000"><b>!=</b></font><font color="#000000"> </font><font color="#27408B">lastStyle</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
                        </i></font><font color="#000000"><b>if</b></font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">lastStyle</font><font color="#000000"> </font><font color="#000000"><b>!=</b></font><font color="#000000"> </font><font color="#000000"><b>-</b></font><font color="#006400">1</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
                                </i></font><font color="#A52A2A">fprintf</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">fp</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"%s"</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">colorTagCloseData</font><font color="#000000"><b>[</b></font><font color="#27408B">lastStyle</font><font color="#000000"> </font><font color="#000000"><b>-</b></font><font color="#000000"> </font><font color="#006400">'A'</font><font color="#000000"><b>]</b></font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                        </i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i>
                        </i></font><font color="#A52A2A">fprintf</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">fp</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"%s"</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">colorTagData</font><font color="#000000"><b>[</b></font><font color="#27408B">currentStyle</font><font color="#000000"> </font><font color="#000000"><b>-</b></font><font color="#000000"> </font><font color="#006400">'A'</font><font color="#000000"><b>]</b></font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                        </i></font><font color="#27408B">lastStyle</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#27408B">currentStyle</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i>

                </i></font><font color="#333333"><i>/* Convert characters to HTML escape sequences */</i></font><font color="#000000">
                </font><font color="#000000"><b>if</b></font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">fileString</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"> </font><font color="#000000"><b>==</b></font><font color="#000000"> </font><font color="#006400">'&lt;'</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
                        </i></font><font color="#A52A2A">fprintf</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">fp</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"&lt;"</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i> </i></font><font color="#000000"><b>else</b></font><font color="#000000"> </font><font color="#000000"><b>if</b></font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">fileString</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"> </font><font color="#000000"><b>==</b></font><font color="#000000"> </font><font color="#006400">'&gt;'</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
                        </i></font><font color="#A52A2A">fprintf</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">fp</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"&gt;"</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i> </i></font><font color="#000000"><b>else</b></font><font color="#000000"> </font><font color="#000000"><b>if</b></font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">fileString</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"> </font><font color="#000000"><b>==</b></font><font color="#000000"> </font><font color="#006400">'\t'</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
                        </i></font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">j</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                        </i></font><font color="#000000"><b>for</b></font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">j</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#006400">0</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i> </i></font><font color="#27408B">j</font><font color="#000000"> </font><font color="#000000"><b>&lt;</b></font><font color="#000000"> </font><font color="#27408B">tabDist</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i> </i></font><font color="#27408B">j</font><font color="#000000"><b>++</b></font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000">
                                </font><font color="#A52A2A">fprintf</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">fp</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">" "</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i> </i></font><font color="#000000"><b>else</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
                        </i></font><font color="#A52A2A">putc</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">fileString</font><font color="#000000"><b>[</b></font><font color="#27408B">i</font><font color="#000000"><b>]</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">fp</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i>
        </i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A">fprintf</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">fp</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;"</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A">putc</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#006400">'\n'</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">fp</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A">fflush</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">fp</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A">fclose</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">fp</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A">XtFree</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">styleString</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
        </i></font><font color="#A52A2A">XtFree</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">fileString</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>

        </i></font><font color="#A52A2A">EndWait</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">shell</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
</i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i> </i></font><font color="#333333"><i>/* exportToHTML */</i></font><font color="#000000">


</font><font color="#333333"><i>/*
** Wrapper for strerror so all the calls don't have to be ifdef'd for VMS.
*/</i></font><font color="#000000">
</font><font color="#A52A2A"><b>static</b></font><font color="#000000"> </font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#A52A2A">errorString</font><font color="#000000"><b>(</b></font><font color="#A52A2A"><b>void</b></font><font color="#000000"><b>)</b></font><font color="#000000">
</font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
</i></font><font color="#27408B">#ifdef VMS</font><font color="#000000">
    </font><font color="#000000"><b>return</b></font><font color="#000000"> </font><font color="#A52A2A">strerror</font><font color="#000000"><b>(</b></font><font color="#27408B">errno</font><font color="#000000"><b>,</b></font><font color="#000000"> vaxc$errno</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
</i></font><font color="#27408B">#else</font><font color="#000000">
    </font><font color="#000000"><b>return</b></font><font color="#000000"> </font><font color="#A52A2A">strerror</font><font color="#000000"><b>(</b></font><font color="#27408B">errno</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
</i></font><font color="#27408B">#endif</font><font color="#000000">
</font><font color="#000000"><b>}</b></font><font color="#FF0000"><i>


</i></font><font color="#333333"><i>/*
** Wrapper for GetNewFilename which uses the current window's path
** (if set) as the default directory, and asks about embedding newlines
** to make wrapping permanent.
*/</i></font><font color="#000000">
</font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#A52A2A">PromptForHTMLFile</font><font color="#000000"><b>(</b></font><font color="#27408B">WindowInfo</font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">window</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">prompt</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">fullname</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000">
</font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A"><b>int</b></font><font color="#000000"> </font><font color="#27408B">n</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">retVal</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#27408B">Arg</font><font color="#000000"> </font><font color="#27408B">args</font><font color="#000000"><b>[</b></font><font color="#006400">20</font><font color="#000000"><b>]</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#27408B">XmString</font><font color="#000000"> </font><font color="#27408B">s1</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">s2</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#27408B">Widget</font><font color="#000000"> </font><font color="#27408B">fileSB</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#000000"><b>*</b></font><font color="#27408B">savedDefaultDir</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#A52A2A"><b>char</b></font><font color="#000000"> </font><font color="#27408B">filename</font><font color="#000000"><b>[</b></font><font color="#27408B">MAXPATHLEN</font><font color="#000000"><b>]</b></font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#006400">""</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    
    </i></font><font color="#000000"><b>if</b></font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">filenameSet</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"> </font><font color="#000000"><b>{</b></font><font color="#FF0000"><i>
                        
                        </i></font><font color="#A52A2A">strcat</font><font color="#000000"><b>(</b></font><font color="#000000">        </font><font color="#27408B">filename</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">filename</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                        </i></font><font color="#A52A2A">strcat</font><font color="#000000"><b>(</b></font><font color="#000000"> </font><font color="#27408B">filename</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">".html"</font><font color="#000000"> </font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
                </i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i>         
    </i></font><font color="#333333"><i>/* Temporarily set default directory to window-&gt;path, prompt for file,
       then, if the call was unsuccessful, restore the original default
       directory */</i></font><font color="#000000">
    </font><font color="#27408B">savedDefaultDir</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#A52A2A">GetFileDialogDefaultDirectory</font><font color="#000000"><b>()</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#000000"><b>if</b></font><font color="#000000"> </font><font color="#000000"><b>(</b></font><font color="#000000"><b>*</b></font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">path</font><font color="#000000"> </font><font color="#000000"><b>!=</b></font><font color="#000000"> </font><font color="#006400">'\0'</font><font color="#000000"><b>)</b></font><font color="#000000">
            </font><font color="#A52A2A">SetFileDialogDefaultDirectory</font><font color="#000000"><b>(</b></font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">path</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    
    </i></font><font color="#333333"><i>/* Present a file selection dialog with an added field for requesting
       long line wrapping to become permanent via inserted newlines */</i></font><font color="#000000">
    </font><font color="#27408B">n</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#006400">0</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A">XtSetArg</font><font color="#000000"><b>(</b></font><font color="#27408B">args</font><font color="#000000"><b>[</b></font><font color="#27408B">n</font><font color="#000000"><b>]</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmNselectionLabelString</font><font color="#000000"><b>,</b></font><font color="#000000"> 
                </font><font color="#27408B">s1</font><font color="#000000"><b>=</b></font><font color="#A52A2A">XmStringCreateSimple</font><font color="#000000"><b>(</b></font><font color="#27408B">prompt</font><font color="#000000"><b>))</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i> </i></font><font color="#27408B">n</font><font color="#000000"><b>++</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>     
    </i></font><font color="#A52A2A">XtSetArg</font><font color="#000000"><b>(</b></font><font color="#27408B">args</font><font color="#000000"><b>[</b></font><font color="#27408B">n</font><font color="#000000"><b>]</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmNdialogStyle</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmDIALOG_FULL_APPLICATION_MODAL</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i> </i></font><font color="#27408B">n</font><font color="#000000"><b>++</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A">XtSetArg</font><font color="#000000"><b>(</b></font><font color="#27408B">args</font><font color="#000000"><b>[</b></font><font color="#27408B">n</font><font color="#000000"><b>]</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmNdialogTitle</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">s2</font><font color="#000000"><b>=</b></font><font color="#A52A2A">XmStringCreateSimple</font><font color="#000000"><b>(</b></font><font color="#006400">" "</font><font color="#000000"><b>))</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i> </i></font><font color="#27408B">n</font><font color="#000000"><b>++</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A">XtSetArg</font><font color="#000000"><b>(</b></font><font color="#27408B">args</font><font color="#000000"><b>[</b></font><font color="#27408B">n</font><font color="#000000"><b>]</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmNresizePolicy</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmRESIZE_GROW</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i> </i></font><font color="#27408B">n</font><font color="#000000"><b>++</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#27408B">fileSB</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#A52A2A">XmCreateFileSelectionDialog</font><font color="#000000"><b>(</b></font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">shell</font><font color="#000000"><b>,</b></font><font color="#006400">"FileSelect"</font><font color="#000000"><b>,</b></font><font color="#27408B">args</font><font color="#000000"><b>,</b></font><font color="#27408B">n</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A">XmStringFree</font><font color="#000000"><b>(</b></font><font color="#27408B">s1</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A">XmStringFree</font><font color="#000000"><b>(</b></font><font color="#27408B">s2</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>

    </i></font><font color="#A52A2A">XtVaSetValues</font><font color="#000000"><b>(</b></font><font color="#A52A2A">XmFileSelectionBoxGetChild</font><font color="#000000"><b>(</b></font><font color="#27408B">fileSB</font><font color="#000000"><b>,</b></font><font color="#000000">
                </font><font color="#27408B">XmDIALOG_FILTER_LABEL</font><font color="#000000"><b>)</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmNmnemonic</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">'l'</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmNuserData</font><font color="#000000"><b>,</b></font><font color="#000000">
                </font><font color="#A52A2A">XmFileSelectionBoxGetChild</font><font color="#000000"><b>(</b></font><font color="#27408B">fileSB</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmDIALOG_FILTER_TEXT</font><font color="#000000"><b>)</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">0</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A">XtVaSetValues</font><font color="#000000"><b>(</b></font><font color="#A52A2A">XmFileSelectionBoxGetChild</font><font color="#000000"><b>(</b></font><font color="#27408B">fileSB</font><font color="#000000"><b>,</b></font><font color="#000000">
                </font><font color="#27408B">XmDIALOG_DIR_LIST_LABEL</font><font color="#000000"><b>)</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmNmnemonic</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">'D'</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmNuserData</font><font color="#000000"><b>,</b></font><font color="#000000">
                </font><font color="#A52A2A">XmFileSelectionBoxGetChild</font><font color="#000000"><b>(</b></font><font color="#27408B">fileSB</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmDIALOG_DIR_LIST</font><font color="#000000"><b>)</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">0</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A">XtVaSetValues</font><font color="#000000"><b>(</b></font><font color="#A52A2A">XmFileSelectionBoxGetChild</font><font color="#000000"><b>(</b></font><font color="#27408B">fileSB</font><font color="#000000"><b>,</b></font><font color="#000000">
                </font><font color="#27408B">XmDIALOG_LIST_LABEL</font><font color="#000000"><b>)</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmNmnemonic</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">'F'</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmNuserData</font><font color="#000000"><b>,</b></font><font color="#000000">
                </font><font color="#A52A2A">XmFileSelectionBoxGetChild</font><font color="#000000"><b>(</b></font><font color="#27408B">fileSB</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmDIALOG_LIST</font><font color="#000000"><b>)</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">0</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A">XtVaSetValues</font><font color="#000000"><b>(</b></font><font color="#A52A2A">XmFileSelectionBoxGetChild</font><font color="#000000"><b>(</b></font><font color="#27408B">fileSB</font><font color="#000000"><b>,</b></font><font color="#000000">
                </font><font color="#27408B">XmDIALOG_SELECTION_LABEL</font><font color="#000000"><b>)</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmNmnemonic</font><font color="#000000"><b>,</b></font><font color="#000000">
                </font><font color="#27408B">prompt</font><font color="#000000"><b>[</b></font><font color="#A52A2A">strspn</font><font color="#000000"><b>(</b></font><font color="#27408B">prompt</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">"lFD"</font><font color="#000000"><b>)]</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmNuserData</font><font color="#000000"><b>,</b></font><font color="#000000">
                </font><font color="#A52A2A">XmFileSelectionBoxGetChild</font><font color="#000000"><b>(</b></font><font color="#27408B">fileSB</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmDIALOG_TEXT</font><font color="#000000"><b>)</b></font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#006400">0</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A">AddDialogMnemonicHandler</font><font color="#000000"><b>(</b></font><font color="#27408B">fileSB</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">FALSE</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A">RemapDeleteKey</font><font color="#000000"><b>(</b></font><font color="#A52A2A">XmFileSelectionBoxGetChild</font><font color="#000000"><b>(</b></font><font color="#27408B">fileSB</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmDIALOG_FILTER_TEXT</font><font color="#000000"><b>))</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#A52A2A">RemapDeleteKey</font><font color="#000000"><b>(</b></font><font color="#A52A2A">XmFileSelectionBoxGetChild</font><font color="#000000"><b>(</b></font><font color="#27408B">fileSB</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">XmDIALOG_TEXT</font><font color="#000000"><b>))</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#27408B">retVal</font><font color="#000000"> </font><font color="#000000"><b>=</b></font><font color="#000000"> </font><font color="#A52A2A">HandleCustomNewFileSB</font><font color="#000000"><b>(</b></font><font color="#27408B">fileSB</font><font color="#000000"><b>,</b></font><font color="#000000"> </font><font color="#27408B">fullname</font><font color="#000000"><b>,</b></font><font color="#000000">
                </font><font color="#27408B">window</font><font color="#000000"><b>-&gt;</b></font><font color="#27408B">filenameSet</font><font color="#000000"> </font><font color="#000000"><b>?</b></font><font color="#000000"> </font><font color="#27408B">filename</font><font color="#000000"> </font><font color="#000000"><b>:</b></font><font color="#000000"> </font><font color="#27408B">NULL</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>

    </i></font><font color="#000000"><b>if</b></font><font color="#000000"> </font><font color="#000000"><b>(</b></font><font color="#27408B">retVal</font><font color="#000000"> </font><font color="#000000"><b>!=</b></font><font color="#000000"> </font><font color="#27408B">GFN_OK</font><font color="#000000"><b>)</b></font><font color="#000000">
            </font><font color="#A52A2A">SetFileDialogDefaultDirectory</font><font color="#000000"><b>(</b></font><font color="#27408B">savedDefaultDir</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#000000"><b>if</b></font><font color="#000000"> </font><font color="#000000"><b>(</b></font><font color="#27408B">savedDefaultDir</font><font color="#000000"> </font><font color="#000000"><b>!=</b></font><font color="#000000"> </font><font color="#27408B">NULL</font><font color="#000000"><b>)</b></font><font color="#000000">
            </font><font color="#A52A2A">XtFree</font><font color="#000000"><b>(</b></font><font color="#27408B">savedDefaultDir</font><font color="#000000"><b>)</b></font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
    </i></font><font color="#000000"><b>return</b></font><font color="#000000"> </font><font color="#27408B">retVal</font><font color="#000000"><b>;</b></font><font color="#FF0000"><i>
</i></font><font color="#000000"><b>}</b></font><font color="#FF0000"><i>
</pre></body></html>
